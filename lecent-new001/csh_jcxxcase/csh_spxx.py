from selenium import webdriver
from selenium.webdriver.support.select import Select
import sys,time,unittest
import common.ReadConfig as co
sys.path.append('..')
from pages.loginpage import LoginPage
from pages.spxxpage import SpxxPage
import utils.util as ut
file1=ut.DATA_PATH+'/user_data.csv'
data1=ut.get_data(file1)
file2=ut.DATA_PATH+'/spxx_data.csv'
data2=ut.get_data(file2)
url=co.getbrowsername('Url')
mark1=1
spzhlxA = '1'
spzhlxB = '2'
spzhlxAB = '3'
spzhlxBA = '4'
spzhlxW = '5'

class TestSpxx(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls.driver = webdriver.Firefox()
        cls.driver.maximize_window()
        cls.driver.get(url)
        time.sleep(2)
        cls.dl = LoginPage(cls.driver, Select)
        cls.spxx = SpxxPage(cls.driver, Select)

    @classmethod
    def tearDownClass(cls):
        cls.driver.quit()

    def tearDown(self):
        global mark1
        mark1 += 1
        self.driver.refresh()

    def testcase1(cls):
        '''用例1，新增A账户类型商品A-1成功'''
        cls.dl.input_name(data1[mark1][0])
        time.sleep(2)
        cls.dl.input_pwd(data1[mark1][1])
        time.sleep(3)
        cls.dl.click_login()
        time.sleep(3)
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxA)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase2(cls):
        '''用例2，新增A账户类型商品A-2成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxA)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase3(cls):
        '''用例3，新增B账户类型商品B-1成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxB)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase4(cls):
        '''用例4，新增B账户类型商品B-2成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxB)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase5(cls):
        '''用例5，新增AB账户类型商品AB-1成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxAB)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase6(cls):
        '''用例6，新增AB账户类型商品AB-2成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxAB)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase7(cls):
        '''用例7，新增BA账户类型商品BA-1成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxBA)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase8(cls):
        '''用例8，新增BA账户类型商品BA-2成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxBA)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase9(cls):
        '''用例9，新增无限制账户类型商品无-1成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxW)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)

    def testcase10(cls):
        '''用例10，新增无限制账户类型商品无-2成功'''
        cls.spxx.click_jcxxgl()
        time.sleep(2)
        cls.spxx.click_spxxgl()
        time.sleep(2)
        cls.spxx.switch_sptj()
        time.sleep(2)
        cls.spxx.click_sptj()
        time.sleep(2)
        cls.spxx.input_spmc(data2[mark1][1])
        time.sleep(2)
        cls.spxx.click_spfl()
        time.sleep(2)
        cls.spxx.input_spfl(data2[mark1][2])
        time.sleep(2)
        cls.spxx.input_spbm(data2[mark1][3])
        time.sleep(2)
        cls.spxx.input_spbzq(data2[mark1][4])
        time.sleep(3)
        cls.spxx.select_spzhlx(spzhlxW)
        time.sleep(3)
        cls.spxx.click_spsxgl()
        time.sleep(2)
        cls.spxx.click_ygsx()
        time.sleep(2)
        cls.spxx.click_ygsxxz()
        time.sleep(2)
        cls.spxx.click_spgg()
        time.sleep(2)
        cls.spxx.input_spgg(data2[mark1][5])
        time.sleep(2)
        cls.spxx.click_spxh()
        time.sleep(2)
        cls.spxx.input_spxh(data2[mark1][6])
        time.sleep(2)
        cls.spxx.click_spdw()
        time.sleep(2)
        cls.spxx.input_spdw(data2[mark1][7])
        time.sleep(2)
        cls.spxx.input_spcb(data2[mark1][8])
        time.sleep(2)
        cls.spxx.input_spls(data2[mark1][9])
        time.sleep(2)
        cls.spxx.input_spkcyj(data2[mark1][10])
        time.sleep(2)
        cls.spxx.click_bcnr()
        time.sleep(2)


if __name__=='__main__':
    unittest.main()

